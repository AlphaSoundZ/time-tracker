import{d as g,r as v,o as y,t as p,s as i,a as r,c as d,b as n,F as T,e as S,f as o,g as f,p as V,h as x,_ as I}from"./index-d5132772.js";const u=c=>(V("data-v-5d461277"),c=c(),x(),c),L={class:"container"},M=u(()=>n("h1",null,"Dashboard",-1)),B={key:0},N={class:"table"},C=u(()=>n("thead",null,[n("tr",null,[n("th",null,"Title"),n("th",null,"Date"),n("th",null,"Start"),n("th",null,"End"),n("th",null,"Duration")])],-1)),E=u(()=>n("td",{colspan:"4"},"Total",-1)),F={key:1,class:"title"},$=u(()=>n("h2",null,"No trackings yet",-1)),j=[$],q=u(()=>n("br",null,null,-1)),z=g({__name:"DashboardView",setup(c){const s=v([]);async function m(){const{data:e}=await i.from("trackings").select();s.value=e,i.channel("any").on("postgres_changes",{event:"*",schema:"public",table:"trackings"},async a=>{const{data:t}=await i.from("trackings").select();s.value=t}).subscribe()}function D(e){if(!e.end)return"in progress";const a=new Date(e.start),l=new Date(e.end).getTime()-a.getTime();return _(l)}function _(e){e=new Date(e).getTime();const a=Math.floor(e/1e3/60/60),t=Math.floor(e/1e3/60)%60,l=Math.floor(e/1e3)%60;return[a,t,l].map(b=>String(b).padStart(2,"0")).join(":")}function h(e){if(e)return new Date(e).toLocaleTimeString().slice(0,8)}function w(e){let a=new Date(e.start).toLocaleDateString();if(e.end){let t=new Date(e.end).toLocaleDateString();return a===t?a:`${a} - ${t}`}return a}return y(async()=>{var t;p.show();const{data:e,error:a}=await i.auth.getSession();e&&((t=e.session)==null||t.user,m().then(()=>{p.hide()}))}),(e,a)=>(r(),d("div",L,[M,s.value.length!==0?(r(),d("div",B,[n("table",N,[C,n("tbody",null,[(r(!0),d(T,null,S(s.value,t=>(r(),d("tr",{key:t.id},[n("td",null,o(t.title),1),n("td",null,o(w(t)),1),n("td",null,o(h(t.start)),1),n("td",null,o(t.end?h(t.end):""),1),n("td",null,o(D(t)),1)]))),128))]),n("tfoot",null,[n("tr",null,[E,n("td",null,o(_(s.value.map(t=>t.end?new Date(t.end).getTime()-new Date(t.start).getTime():0).reduce((t,l)=>t+l,0))),1)])])])])):f("",!0),s.value.length===0?(r(),d("div",F,j)):f("",!0),q]))}});const H=I(z,[["__scopeId","data-v-5d461277"]]);export{H as default};
