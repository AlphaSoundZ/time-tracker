import{d as I,r as m,o as k,t as w,s as S,a as l,c as r,b as t,F as p,e as f,f as o,g,p as N,h as V,_ as x}from"./index-15d06e80.js";import{T as L}from"./track-87b30f9b.js";const u=i=>(N("data-v-e513504e"),i=i(),V(),i),M={class:"container"},B=u(()=>t("h1",null,"Dashboard",-1)),E={key:0,hidden:""},G={class:"table"},j=u(()=>t("thead",null,[t("tr",null,[t("th",null,"Title"),t("th",null,"Date"),t("th",null,"Start"),t("th",null,"End"),t("th",null,"Duration")])],-1)),C=u(()=>t("td",{colspan:"4"},"Total",-1)),F={key:1},J={class:"groups"},O=u(()=>t("br",null,null,-1)),$={class:"table"},q=u(()=>t("thead",null,[t("tr",null,[t("th",null,"Start"),t("th",null,"End"),t("th",null,"Duration"),t("th",null,"Tags")])],-1)),z={key:2,class:"title"},A=u(()=>t("h2",null,"No trackings yet",-1)),H=[A],K=u(()=>t("br",null,null,-1)),P=I({__name:"DashboardView",setup(i){const _=m([]),d=m([]);async function v(){const n=sessionStorage.getItem("groupedTrackings");n&&n!=="[]"&&(d.value=JSON.parse(n));const a=new L(S),{data:e}=await a.getTrackingGroups();d.value=e,console.log(e),sessionStorage.setItem("groupedTrackings",JSON.stringify(e))}function D(n){if(!n.end)return"in progress";const a=new Date(n.start),s=new Date(n.end).getTime()-a.getTime();return h(s)}function h(n){n=new Date(n).getTime();const a=Math.floor(n/1e3/60/60),e=Math.floor(n/1e3/60)%60,s=Math.floor(n/1e3)%60;return[a,e,s].map(y=>String(y).padStart(2,"0")).join(":")}function c(n){if(n)return new Date(n).toLocaleTimeString().slice(0,8)}function b(n){let a=new Date(n.start).toLocaleDateString();if(n.end){let e=new Date(n.end).toLocaleDateString();return a===e?a:`${a} - ${e}`}return a}return k(async()=>{var e;w.show();const{data:n,error:a}=await S.auth.getSession();n&&((e=n.session)==null||e.user,v().then(()=>{w.hide()}))}),(n,a)=>(l(),r("div",M,[B,_.value.length!==0?(l(),r("div",E,[t("table",G,[j,t("tbody",null,[(l(!0),r(p,null,f(_.value,e=>(l(),r("tr",{key:e.id},[t("td",null,o(e.title),1),t("td",null,o(b(e)),1),t("td",null,o(c(e.start)),1),t("td",null,o(e.end?c(e.end):""),1),t("td",null,o(D(e)),1)]))),128))]),t("tfoot",null,[t("tr",null,[C,t("td",null,o(h(_.value.map(e=>e.end?new Date(e.end).getTime()-new Date(e.start).getTime():0).reduce((e,s)=>e+s,0))),1)])])])])):g("",!0),d.value.length!==0?(l(),r("div",F,[(l(!0),r(p,null,f(d.value,e=>(l(),r("div",J,[O,t("h2",null,o(e[0].title)+" on "+o(e[0].end?new Date(e[0].end).toDateString():"")+" ("+o(h(e.map(s=>s.end?new Date(s.end).getTime()-new Date(s.start).getTime():0).reduce((s,T)=>s+T,0)))+")",1),t("table",$,[q,t("tbody",null,[(l(!0),r(p,null,f(e,s=>(l(),r("tr",{key:s.id},[t("td",null,o(c(s.start)),1),t("td",null,o(s.end?c(s.end):""),1),t("td",null,o(D(s)),1),t("td",null,o(s.tags.join(", ")),1)]))),128))])])]))),256))])):g("",!0),d.value.length===0?(l(),r("div",z,H)):g("",!0),K]))}});const U=x(P,[["__scopeId","data-v-e513504e"]]);export{U as default};
